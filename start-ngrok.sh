#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Å–∞–π—Ç–∞ —Å Ngrok —Ç—É–Ω–Ω–µ–ª–µ–º
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: ./start-ngrok.sh

echo "üöÄ –ó–∞–ø—É—Å–∫ —Å–∞–π—Ç–∞ —Å Ngrok —Ç—É–Ω–Ω–µ–ª–µ–º..."
echo ""

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–ø—É—â–µ–Ω –ª–∏ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
if ! docker-compose ps | grep -q "Up"; then
    echo "üì¶ –ó–∞–ø—É—Å–∫–∞–µ–º Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä..."
    docker-compose up -d --build
    echo "‚è≥ –ñ–¥–µ–º –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞..."
    sleep 5
else
    echo "‚úÖ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —É–∂–µ –∑–∞–ø—É—â–µ–Ω"
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ ngrok
if ! command -v ngrok &> /dev/null; then
    echo "‚ùå Ngrok –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!"
    echo ""
    echo "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Ngrok:"
    echo "  macOS: brew install ngrok/ngrok/ngrok"
    echo "  –ò–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ: https://ngrok.com/download"
    echo ""
    exit 1
fi

echo "üåê –ó–∞–ø—É—Å–∫–∞–µ–º Ngrok —Ç—É–Ω–Ω–µ–ª—å..."
echo ""
echo "üìã –ü—É–±–ª–∏—á–Ω—ã–π URL –±—É–¥–µ—Ç –ø–æ–∫–∞–∑–∞–Ω –Ω–∏–∂–µ:"
echo "   –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –µ–≥–æ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –¥—Ä—É–≥–æ–º—É —á–µ–ª–æ–≤–µ–∫—É"
echo ""
echo "‚ö†Ô∏è  –ù–∞–∂–º–∏—Ç–µ Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏"
echo ""

# –ó–∞–ø—É—Å–∫–∞–µ–º ngrok
ngrok http 3000

